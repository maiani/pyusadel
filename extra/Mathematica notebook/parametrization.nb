(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    136104,       3545]
NotebookOptionsPosition[    129457,       3429]
NotebookOutlinePosition[    129890,       3446]
CellTagsIndexPosition[    129847,       3443]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Usadel equation in the Ivanov - Fominov parametrization ", "Title",
 CellChangeTimes->{{3.8848884230996885`*^9, 
  3.8848884490796547`*^9}},ExpressionUUID->"f4f6e3f8-cae6-4977-aed0-\
7aa8d93aa800"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "\[Theta]", ",", " ", "M0", ",", " ", "Mx", ",", " ", "My", ",", " ", 
   "Mz"}], "]"}]], "Input",
 CellChangeTimes->{{3.8920904346164374`*^9, 3.8920904757263155`*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"f6f96913-ebcd-4450-a55c-46890a450925"],

Cell[CellGroupData[{

Cell["Parametrization", "Subsection",
 CellChangeTimes->{{3.892090184425915*^9, 
  3.892090186855516*^9}},ExpressionUUID->"ace95b84-f794-4ef7-911d-\
59d9c6541adf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"M0", "^", "2"}], " ", "-", " ", 
      RowBox[{"Mx", "^", "2"}], " ", "-", 
      RowBox[{"My", "^", "2"}], "-", 
      RowBox[{"Mz", "^", "2"}]}], " ", "==", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.87353611425741*^9, 3.8735361873595266`*^9}, {
   3.873536265246185*^9, 3.8735362653718185`*^9}, 3.8735365853809843`*^9, {
   3.8735366779073105`*^9, 3.873536694357802*^9}, {3.8735367381227293`*^9, 
   3.8735367381383553`*^9}, {3.8735371674702034`*^9, 
   3.8735371736915054`*^9}, {3.8848876348943863`*^9, 3.8848876362165356`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"cb4c2bde-7c3c-4179-b5e5-a1e5bd65c6e2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", "M0", " ", 
         RowBox[{"PauliMatrix", "[", "0", "]"}]}], " ", "+", 
        RowBox[{"I", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mx", " ", 
            RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
           RowBox[{"My", " ", 
            RowBox[{"PauliMatrix", "[", "2", "]"}]}], "+", 
           RowBox[{"Mz", " ", 
            RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], 
     "\[IndentingNewLine]", "]"}], "+", " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "1", "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "M0", " ", 
         RowBox[{"PauliMatrix", "[", "0", "]"}]}], " ", "-", 
        RowBox[{"I", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mx", " ", 
            RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
           RowBox[{"My", " ", 
            RowBox[{"PauliMatrix", "[", "2", "]"}]}], "+", 
           RowBox[{"Mz", " ", 
            RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", "g", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.871712081675296*^9, 3.8717122206628857`*^9}, {
  3.8717125368545165`*^9, 3.871712539867895*^9}, {3.8735361933804054`*^9, 
  3.8735362327293878`*^9}, {3.8735365470051413`*^9, 3.8735365642044697`*^9}, {
  3.8735367381383553`*^9, 3.8735367381856174`*^9}, {3.8848877401006994`*^9, 
  3.8848877624717264`*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"958d1f58-fa67-413c-861f-0f6a3e92f0ae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"M0", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "Mz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "Mx"}], "+", "My"}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "Mz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"M0", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "-", "My"}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]},
     {
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"Mx", "+", 
         RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"M0", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "Mz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "+", "My"}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "Mz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"M0", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "Mz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"M0", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "-", "My"}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "M0"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "Mz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "-", "My"}], ")"}], 
       " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "+", "My"}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "Mz", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"M0", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "+", "My"}], ")"}], 
       " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "M0"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "Mz", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8735367478117933`*^9, 3.873537174966651*^9, {3.884881931794983*^9, 
   3.884881937006854*^9}, 3.88488382748403*^9, 3.884883903863058*^9, 
   3.8848870872845592`*^9, 3.8848876382280645`*^9, {3.8848877468542275`*^9, 
   3.884887763023521*^9}, 3.8848884554751167`*^9, 3.89209032822008*^9, 
   3.8920904160632973`*^9, {3.8920904647510967`*^9, 3.892090479995002*^9}},
 CellLabel->
  "Out[309]//MatrixForm=",ExpressionUUID->"a25f112b-2733-417c-9284-\
731da6b24626"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Central part", "Subsection",
 CellChangeTimes->{{3.8920902260177183`*^9, 
  3.89209022855224*^9}},ExpressionUUID->"6095120b-057c-40fd-93b8-\
b5ec2c1d2345"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", " ", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
           RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], " ", "+", 
        RowBox[{"\[CapitalDelta]", " ", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"PauliMatrix", "[", "1", "]"}], ",", " ", 
           RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}]}], ")"}], ".", 
      "g"}], "-", 
     RowBox[{"g", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Omega]", " ", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
           RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], " ", "+", 
        RowBox[{"\[CapitalDelta]", " ", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"PauliMatrix", "[", "1", "]"}], ",", " ", 
           RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}]}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"a", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8735369677071886`*^9, 3.8735370571779213`*^9}, {
   3.8735373119794893`*^9, 3.8735373154693136`*^9}, 3.8848870516812725`*^9},
 CellLabel->
  "In[310]:=",ExpressionUUID->"e0a295bc-43dd-48c2-9fea-9996a96e7b55"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M0", " ", "\[CapitalDelta]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "Mz", " ", "\[Omega]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "Mz", " ", 
           "\[CapitalDelta]"}], "+", 
          RowBox[{"M0", " ", "\[Omega]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "Mx"}], "+", "My"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"\[CapitalDelta]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "+", "My"}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"\[CapitalDelta]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M0", " ", "\[CapitalDelta]"}], "+", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "Mz", " ", "\[Omega]"}]}], 
         ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "Mz", " ", "\[CapitalDelta]"}], "+", 
          RowBox[{"M0", " ", "\[Omega]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "M0", " ", "\[CapitalDelta]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "Mz", " ", "\[Omega]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{
       "2", " ", "\[ImaginaryI]", " ", "Mz", " ", "\[CapitalDelta]", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{"2", " ", "M0", " ", "\[Omega]", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "Mx"}], "+", "My"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"\[CapitalDelta]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "0", "0"},
     {
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"Mx", "+", 
         RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"\[CapitalDelta]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M0", " ", "\[CapitalDelta]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "Mz", " ", "\[Omega]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "Mz", " ", "\[CapitalDelta]"}], "+", 
          RowBox[{"M0", " ", "\[Omega]"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.873536987326984*^9, 3.8735370575713797`*^9}, 
   3.8735371994312*^9, 3.873537316936963*^9, 3.884887053207056*^9, 
   3.8848870967260675`*^9, 3.884887957891935*^9, 3.8848884563081503`*^9, 
   3.892090329301038*^9, 3.8920904170297203`*^9, {3.892090465961152*^9, 
   3.8920904810907063`*^9}},
 CellLabel->
  "Out[311]//MatrixForm=",ExpressionUUID->"ecffd719-8245-4ecd-9dc6-\
74f6f091a482"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"I", " ", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Tr", "[", 
     RowBox[{"a", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
   "4"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"a", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"a", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"a", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}]}], "Input",
 CellChangeTimes->{{3.873537248447229*^9, 3.8735373713982573`*^9}, {
  3.8848871182960625`*^9, 3.8848871375653524`*^9}, {3.8848879823363514`*^9, 
  3.884887988547327*^9}, {3.884888040692412*^9, 3.884888052426907*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"a317a16c-edb9-4601-a3fb-065d9012d77f"],

Cell[BoxData[
 RowBox[{"2", " ", "M0", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
    RowBox[{"\[Omega]", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.873537253677354*^9, 3.873537300049595*^9}, {
   3.873537334711382*^9, 3.873537371688715*^9}, {3.8848871191929646`*^9, 
   3.88488713803671*^9}, 3.8848879589439898`*^9, 3.884887989069105*^9, {
   3.8848880415583696`*^9, 3.8848880609802723`*^9}, 3.8848884564112096`*^9, 
   3.8920903296134095`*^9, 3.8920904172885075`*^9, {3.8920904662110395`*^9, 
   3.892090481320305*^9}},
 CellLabel->
  "Out[312]=",ExpressionUUID->"b961f5bf-7465-4bfc-9772-4cf33b52b21b"],

Cell[BoxData[
 RowBox[{"2", " ", "Mx", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Omega]", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"\[CapitalDelta]", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.873537253677354*^9, 3.873537300049595*^9}, {
   3.873537334711382*^9, 3.873537371688715*^9}, {3.8848871191929646`*^9, 
   3.88488713803671*^9}, 3.8848879589439898`*^9, 3.884887989069105*^9, {
   3.8848880415583696`*^9, 3.8848880609802723`*^9}, 3.8848884564112096`*^9, 
   3.8920903296134095`*^9, 3.8920904172885075`*^9, {3.8920904662110395`*^9, 
   3.892090481392957*^9}},
 CellLabel->
  "Out[313]=",ExpressionUUID->"ec172b0c-8fba-4da9-bc33-c3f49350b417"],

Cell[BoxData[
 RowBox[{"2", " ", "My", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Omega]", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"\[CapitalDelta]", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.873537253677354*^9, 3.873537300049595*^9}, {
   3.873537334711382*^9, 3.873537371688715*^9}, {3.8848871191929646`*^9, 
   3.88488713803671*^9}, 3.8848879589439898`*^9, 3.884887989069105*^9, {
   3.8848880415583696`*^9, 3.8848880609802723`*^9}, 3.8848884564112096`*^9, 
   3.8920903296134095`*^9, 3.8920904172885075`*^9, {3.8920904662110395`*^9, 
   3.8920904814074845`*^9}},
 CellLabel->
  "Out[314]=",ExpressionUUID->"c6f79f6c-98d3-4053-806d-ad2a1039e6a6"],

Cell[BoxData[
 RowBox[{"2", " ", "Mz", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Omega]", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"\[CapitalDelta]", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.873537253677354*^9, 3.873537300049595*^9}, {
   3.873537334711382*^9, 3.873537371688715*^9}, {3.8848871191929646`*^9, 
   3.88488713803671*^9}, 3.8848879589439898`*^9, 3.884887989069105*^9, {
   3.8848880415583696`*^9, 3.8848880609802723`*^9}, 3.8848884564112096`*^9, 
   3.8920903296134095`*^9, 3.8920904172885075`*^9, {3.8920904662110395`*^9, 
   3.8920904814385242`*^9}},
 CellLabel->
  "Out[315]=",ExpressionUUID->"a38a5518-d394-4321-9bbe-c3ba4788bc5e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin flip scattering", "Subsection",
 CellChangeTimes->{{3.8920897845217023`*^9, 3.8920897932061467`*^9}, {
  3.8920902802495775`*^9, 
  3.892090281388961*^9}},ExpressionUUID->"ac6451c9-f360-4aae-871b-\
7588614ee5da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]sf", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}], ".", "g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}], ".", "g"}], "-", 
       RowBox[{"g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}], ".", "g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}]}], "]"}], "/", 
     "8"}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}], ".", "g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}], ".", "g"}], "-", 
       RowBox[{"g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}], ".", "g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}]}], "]"}], "/", 
     "8"}], " ", "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], ".", "g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], ".", "g"}], "-", 
       RowBox[{"g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], ".", "g", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"PauliMatrix", "[", "0", "]"}], ",", " ", 
          RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}]}], "]"}], "/", 
     "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalSigma]sf", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8717122286642585`*^9, 3.8717123080958443`*^9}, {
  3.8717123706233606`*^9, 3.871712376975361*^9}, {3.873536862000529*^9, 
  3.8735368632784557`*^9}, {3.8920872666023903`*^9, 3.8920872677457113`*^9}, {
  3.8920875441761665`*^9, 3.8920875467046556`*^9}, {3.8920899134835577`*^9, 
  3.8920899393506374`*^9}, {3.892090380681246*^9, 3.892090405991829*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"2a2c8d3e-cc54-4720-ba0d-142ceca47fa1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       FractionBox[
        RowBox[{"Mx", " ", "Mz"}], "2"], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"Mx", "-", 
          RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", "Mz"}], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "My", " ", "Mz"}], "2"]}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "M0", " ", "Mz"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", "M0", " ", 
        "Mx"}], "+", 
       RowBox[{
        FractionBox["1", "8"], " ", "M0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "Mx"}], "-", 
          RowBox[{"4", " ", "My"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{"M0", " ", "My"}], "2"]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Mx", " ", "Mz"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"Mx", "+", 
          RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", "Mz"}], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "My", " ", "Mz"}], "2"]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", "M0", " ", 
        "Mx"}], "+", 
       FractionBox[
        RowBox[{"M0", " ", "My"}], "2"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "M0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "+", "My"}], 
         ")"}]}]}], 
      RowBox[{"\[ImaginaryI]", " ", "M0", " ", "Mz"}]},
     {
      RowBox[{"\[ImaginaryI]", " ", "M0", " ", "Mz"}], 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "M0", " ", "Mx"}], "2"], "+", 
       FractionBox[
        RowBox[{"M0", " ", "My"}], "2"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "M0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "Mx"}], "+", "My"}], ")"}]}]}], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"Mx", " ", "Mz"}], "2"], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"Mx", "-", 
          RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", "Mz"}], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "My", " ", "Mz"}], "2"]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "M0", " ", "Mx"}], "2"], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "M0", " ", 
        RowBox[{"(", 
         RowBox[{"Mx", "+", 
          RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{"M0", " ", "My"}], "2"]}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "M0", " ", "Mz"}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Mx", " ", "Mz"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"Mx", "+", 
          RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", "Mz"}], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "My", " ", "Mz"}], "2"]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.873536752461828*^9, 3.8735371906336756`*^9, {3.8920871366753173`*^9, 
   3.89208716259641*^9}, 3.892087198908519*^9, {3.892087242706054*^9, 
   3.892087268705655*^9}, 3.8920875905778055`*^9, 3.892089940262619*^9, 
   3.8920903311667395`*^9, {3.8920904074084435`*^9, 3.89209041761784*^9}, {
   3.892090466702855*^9, 3.892090481626896*^9}},
 CellLabel->
  "Out[317]//MatrixForm=",ExpressionUUID->"b0c189ae-6528-474f-ae76-\
4d13b6967378"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]sf",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"I", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]sf",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]sf",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]sf",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8735365099895678`*^9, 3.8735365320232315`*^9}, {
  3.873536597336339*^9, 3.8735366140454006`*^9}, {3.873536866556529*^9, 
  3.873536930884347*^9}, {3.8920874763285427`*^9, 3.8920875176685925`*^9}, {
  3.8920875498689528`*^9, 3.89208755529683*^9}, {3.892089154637965*^9, 
  3.8920891574761505`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"ed54b07f-d7a9-4f90-978f-564a3ffe0f40"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8920871367768345`*^9, 3.8920871626265965`*^9}, 3.892087198944512*^9, {
   3.8920872544034452`*^9, 3.8920872705992904`*^9}, {3.892087494414364*^9, 
   3.892087518509478*^9}, 3.892087590628235*^9, 3.892089157989114*^9, 
   3.8920899417637243`*^9, 3.89209033160273*^9, {3.8920904098717504`*^9, 
   3.8920904177025404`*^9}, {3.892090466840786*^9, 3.892090481810688*^9}},
 CellLabel->
  "Out[318]=",ExpressionUUID->"268715c3-8bd8-4ba1-983d-5daec168b9e8"],

Cell[BoxData[
 RowBox[{"M0", " ", "Mx"}]], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8920871367768345`*^9, 3.8920871626265965`*^9}, 3.892087198944512*^9, {
   3.8920872544034452`*^9, 3.8920872705992904`*^9}, {3.892087494414364*^9, 
   3.892087518509478*^9}, 3.892087590628235*^9, 3.892089157989114*^9, 
   3.8920899417637243`*^9, 3.89209033160273*^9, {3.8920904098717504`*^9, 
   3.8920904177025404`*^9}, {3.892090466840786*^9, 3.892090481847583*^9}},
 CellLabel->
  "Out[319]=",ExpressionUUID->"392242bd-6977-4cdb-8654-005418f4c8df"],

Cell[BoxData[
 RowBox[{"M0", " ", "My"}]], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8920871367768345`*^9, 3.8920871626265965`*^9}, 3.892087198944512*^9, {
   3.8920872544034452`*^9, 3.8920872705992904`*^9}, {3.892087494414364*^9, 
   3.892087518509478*^9}, 3.892087590628235*^9, 3.892089157989114*^9, 
   3.8920899417637243`*^9, 3.89209033160273*^9, {3.8920904098717504`*^9, 
   3.8920904177025404`*^9}, {3.892090466840786*^9, 3.8920904818771257`*^9}},
 CellLabel->
  "Out[320]=",ExpressionUUID->"fd180499-3e0a-44a2-a947-8cc29a471fad"],

Cell[BoxData[
 RowBox[{"M0", " ", "Mz"}]], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8920871367768345`*^9, 3.8920871626265965`*^9}, 3.892087198944512*^9, {
   3.8920872544034452`*^9, 3.8920872705992904`*^9}, {3.892087494414364*^9, 
   3.892087518509478*^9}, 3.892087590628235*^9, 3.892089157989114*^9, 
   3.8920899417637243`*^9, 3.89209033160273*^9, {3.8920904098717504`*^9, 
   3.8920904177025404`*^9}, {3.892090466840786*^9, 3.892090481906451*^9}},
 CellLabel->
  "Out[321]=",ExpressionUUID->"ace665c9-2f1c-4b30-aa16-705ecb6a9a59"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin orbit scattering", "Subsection",
 CellChangeTimes->{{3.8920902453889923`*^9, 
  3.8920902608344307`*^9}},ExpressionUUID->"af7e8b29-3b7c-405b-a611-\
c8d3c2cccbda"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]so", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}], ".", "g"}], 
     "\[IndentingNewLine]", "\t\t\t", "-", 
     RowBox[{"g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}], ".", "g"}], 
     "\[IndentingNewLine]", "\t\t\t", "-", 
     RowBox[{"g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], ".", "g"}], 
     "\[IndentingNewLine]", "\t\t\t", "-", 
     RowBox[{"g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalSigma]so", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8717122286642585`*^9, 3.8717123080958443`*^9}, {
  3.8717123706233606`*^9, 3.871712376975361*^9}, {3.873536862000529*^9, 
  3.8735368632784557`*^9}, {3.8848873683161116`*^9, 3.8848874496415405`*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"f5c729a7-f11e-4c03-b124-38d36cb5ef47"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mx", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["My", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mz", "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{"Mx", "-", 
         RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}]},
     {"0", "0", 
      RowBox[{"4", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "+", "My"}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}], 
      RowBox[{
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mx", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["My", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mz", "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["M0", "2"]}], "+", 
          SuperscriptBox["Mx", "2"], "+", 
          SuperscriptBox["My", "2"], "+", 
          SuperscriptBox["Mz", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
      RowBox[{"4", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "Mx"}], "+", "My"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "0", "0"},
     {
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{"Mx", "+", 
         RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["M0", "2"]}], "+", 
          SuperscriptBox["Mx", "2"], "+", 
          SuperscriptBox["My", "2"], "+", 
          SuperscriptBox["Mz", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.873536752461828*^9, 3.8735371906336756`*^9, 3.884887087677169*^9, 
   3.88488745034763*^9, 3.8848876397387524`*^9, {3.8848877498819056`*^9, 
   3.8848877644378552`*^9}, 3.8848884558671584`*^9, 3.892090332553477*^9, 
   3.892090418904905*^9, {3.892090468176444*^9, 3.8920904831766148`*^9}},
 CellLabel->
  "Out[323]//MatrixForm=",ExpressionUUID->"de46acf1-38ac-48cc-b004-\
0a05caaa65d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"I", " ", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Tr", "[", 
     RowBox[{
      StyleBox["\[CapitalSigma]so",
       FontWeight->"Plain"], 
      StyleBox[".",
       FontWeight->"Plain"], 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], 
     StyleBox["]",
      FontWeight->"Plain"]}], "]"}], "/", "4"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{
     StyleBox["\[CapitalSigma]so",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], 
    StyleBox["]",
     FontWeight->"Plain"]}], "]"}], "/", "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{
     StyleBox["\[CapitalSigma]so",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], 
    StyleBox["]",
     FontWeight->"Plain"]}], "]"}], "/", "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{
     StyleBox["\[CapitalSigma]so",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}], 
    StyleBox["]",
     FontWeight->"Plain"]}], "]"}], "/", "4"}]}], "Input",
 CellChangeTimes->{{3.8735365099895678`*^9, 3.8735365320232315`*^9}, {
  3.873536597336339*^9, 3.8735366140454006`*^9}, {3.873536866556529*^9, 
  3.873536930884347*^9}, {3.8848871137538533`*^9, 3.8848871141478095`*^9}, {
  3.8848871469619756`*^9, 3.8848871470560474`*^9}, {3.8848872377825813`*^9, 
  3.884887287890937*^9}, {3.884887559140026*^9, 3.8848875809274435`*^9}, {
  3.8848876813225737`*^9, 3.884887713719562*^9}, {3.8848877744937563`*^9, 
  3.8848877746824837`*^9}, {3.884887808274804*^9, 3.884887813680875*^9}, {
  3.88488796862053*^9, 3.884887975737855*^9}, {3.8848880337053995`*^9, 
  3.88488805501619*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"ddc54383-b900-4e3d-ad43-ec1a19b8f514"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["M0", "2"]}], "+", 
      SuperscriptBox["Mx", "2"], "+", 
      SuperscriptBox["My", "2"], "+", 
      SuperscriptBox["Mz", "2"]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8848870932992463`*^9, 3.8848871146341414`*^9}, 3.8848871473236647`*^9, {
   3.8848872398934927`*^9, 3.884887288142047*^9}, {3.884887561971547*^9, 
   3.8848875811645665`*^9}, {3.8848876819667573`*^9, 3.884887714033843*^9}, {
   3.8848877537071867`*^9, 3.8848877749508314`*^9}, {3.8848878088895035`*^9, 
   3.8848878139015656`*^9}, {3.8848879641836*^9, 3.884887976252041*^9}, {
   3.8848880360847836`*^9, 3.884888055334801*^9}, 3.8848884559201536`*^9, 
   3.8920903327863107`*^9, 3.892090419157114*^9, {3.8920904685217867`*^9, 
   3.89209048352483*^9}},
 CellLabel->
  "Out[324]=",ExpressionUUID->"4a707cb5-8eb3-48e5-bba2-73f47466c711"],

Cell[BoxData[
 RowBox[{"4", " ", "M0", " ", "Mx", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", "\[Theta]"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8848870932992463`*^9, 3.8848871146341414`*^9}, 3.8848871473236647`*^9, {
   3.8848872398934927`*^9, 3.884887288142047*^9}, {3.884887561971547*^9, 
   3.8848875811645665`*^9}, {3.8848876819667573`*^9, 3.884887714033843*^9}, {
   3.8848877537071867`*^9, 3.8848877749508314`*^9}, {3.8848878088895035`*^9, 
   3.8848878139015656`*^9}, {3.8848879641836*^9, 3.884887976252041*^9}, {
   3.8848880360847836`*^9, 3.884888055334801*^9}, 3.8848884559201536`*^9, 
   3.8920903327863107`*^9, 3.892090419157114*^9, {3.8920904685217867`*^9, 
   3.892090483538692*^9}},
 CellLabel->
  "Out[325]=",ExpressionUUID->"d60e2611-a46d-4828-9cb5-988749db06ab"],

Cell[BoxData[
 RowBox[{"4", " ", "M0", " ", "My", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", "\[Theta]"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8848870932992463`*^9, 3.8848871146341414`*^9}, 3.8848871473236647`*^9, {
   3.8848872398934927`*^9, 3.884887288142047*^9}, {3.884887561971547*^9, 
   3.8848875811645665`*^9}, {3.8848876819667573`*^9, 3.884887714033843*^9}, {
   3.8848877537071867`*^9, 3.8848877749508314`*^9}, {3.8848878088895035`*^9, 
   3.8848878139015656`*^9}, {3.8848879641836*^9, 3.884887976252041*^9}, {
   3.8848880360847836`*^9, 3.884888055334801*^9}, 3.8848884559201536`*^9, 
   3.8920903327863107`*^9, 3.892090419157114*^9, {3.8920904685217867`*^9, 
   3.89209048355694*^9}},
 CellLabel->
  "Out[326]=",ExpressionUUID->"e275b9d9-d091-4b1c-b46a-2c7d3f23b5b9"],

Cell[BoxData[
 RowBox[{"4", " ", "M0", " ", "Mz", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", "\[Theta]"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.87353675932445*^9, {3.8735368729113054`*^9, 3.8735369311990676`*^9}, {
   3.8848870932992463`*^9, 3.8848871146341414`*^9}, 3.8848871473236647`*^9, {
   3.8848872398934927`*^9, 3.884887288142047*^9}, {3.884887561971547*^9, 
   3.8848875811645665`*^9}, {3.8848876819667573`*^9, 3.884887714033843*^9}, {
   3.8848877537071867`*^9, 3.8848877749508314`*^9}, {3.8848878088895035`*^9, 
   3.8848878139015656`*^9}, {3.8848879641836*^9, 3.884887976252041*^9}, {
   3.8848880360847836`*^9, 3.884888055334801*^9}, 3.8848884559201536`*^9, 
   3.8920903327863107`*^9, 3.892090419157114*^9, {3.8920904685217867`*^9, 
   3.892090483573163*^9}},
 CellLabel->
  "Out[327]=",ExpressionUUID->"4405c21e-cb10-4301-a940-826e666f3db3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Orbital relaxation", "Subsection",
 CellChangeTimes->{{3.8920897325746717`*^9, 
  3.8920897393417892`*^9}},ExpressionUUID->"9f34d863-cd68-4e1c-995d-\
14385d193cfe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]ob", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}], ".", "g"}], "-", 
     RowBox[{"g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}], ".", "g", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalSigma]ob", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.892089577800821*^9, 3.8920896241575747`*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"d55d71fa-1c0f-478f-984b-77ce3053a3c2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mx", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["My", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mz", "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{"Mx", "-", 
         RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}]},
     {"0", "0", 
      RowBox[{"4", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "Mx"}], "+", "My"}], ")"}], 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}], 
      RowBox[{
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mx", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["My", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mz", "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mx", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["My", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Mz", "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], 
      RowBox[{"4", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "Mx"}], "+", "My"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "0", "0"},
     {
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "M0", " ", 
       RowBox[{"(", 
        RowBox[{"Mx", "+", 
         RowBox[{"\[ImaginaryI]", " ", "My"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "M0", " ", "Mz", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["Mx", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["My", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["Mz", "2"]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}]}], "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.892089625105093*^9, 3.892090333656722*^9, 3.8920904201348376`*^9, {
   3.8920904693883495`*^9, 3.8920904843997593`*^9}},
 CellLabel->
  "Out[329]//MatrixForm=",ExpressionUUID->"723b5173-3ab2-4eac-b391-\
f2117d258434"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]ob",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"I", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]ob",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]ob",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Tr", "[", 
   RowBox[{
    RowBox[{
     StyleBox["\[CapitalSigma]ob",
      FontWeight->"Plain"], 
     StyleBox[".",
      FontWeight->"Plain"], 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}], "/", "4"}], 
   StyleBox["]",
    FontWeight->"Plain"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.892089627996403*^9, 3.8920896357568235`*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"bbfbe4c2-a33e-4d42-b63e-fae89452f79c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["Mx", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["My", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["Mz", "2"]}]}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"2", " ", "\[Theta]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8920896011594653`*^9, 3.8920896061349144`*^9}, 
   3.8920896362266874`*^9, 3.89209033382011*^9, 3.8920904203359885`*^9, {
   3.892090469807406*^9, 3.8920904845679026`*^9}},
 CellLabel->
  "Out[330]=",ExpressionUUID->"543ae634-8674-4d8d-a8e6-28dc250bd8ec"],

Cell[BoxData[
 RowBox[{"4", " ", "M0", " ", "Mx", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", "\[Theta]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8920896011594653`*^9, 3.8920896061349144`*^9}, 
   3.8920896362266874`*^9, 3.89209033382011*^9, 3.8920904203359885`*^9, {
   3.892090469807406*^9, 3.8920904845926805`*^9}},
 CellLabel->
  "Out[331]=",ExpressionUUID->"56d475dd-eed4-4f89-b175-b72f5dadb84a"],

Cell[BoxData[
 RowBox[{"4", " ", "M0", " ", "My", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", "\[Theta]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8920896011594653`*^9, 3.8920896061349144`*^9}, 
   3.8920896362266874`*^9, 3.89209033382011*^9, 3.8920904203359885`*^9, {
   3.892090469807406*^9, 3.8920904846114597`*^9}},
 CellLabel->
  "Out[332]=",ExpressionUUID->"bf08e0ee-e2fc-4764-a335-a202851f8c54"],

Cell[BoxData[
 RowBox[{"4", " ", "M0", " ", "Mz", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", "\[Theta]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.8920896011594653`*^9, 3.8920896061349144`*^9}, 
   3.8920896362266874`*^9, 3.89209033382011*^9, 3.8920904203359885`*^9, {
   3.892090469807406*^9, 3.8920904846186934`*^9}},
 CellLabel->
  "Out[333]=",ExpressionUUID->"06d65724-c685-487b-95e4-578ac8682963"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gradient terms", "Subsection",
 CellChangeTimes->{{3.892090300786578*^9, 
  3.8920903054500484`*^9}},ExpressionUUID->"70e552d2-be1a-4bae-9319-\
9e71b4be8916"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"\[Theta]f", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M0", "=", 
   RowBox[{"M0f", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mx", "=", 
   RowBox[{"Mxf", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"My", "=", 
   RowBox[{"Myf", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mz", "=", 
   RowBox[{"Mzf", "[", "x", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.884881940787727*^9, 3.8848819911135607`*^9}, {
  3.8848880701446457`*^9, 3.884888076657968*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"20f3a298-04e6-44bf-ab36-6fd7b38de6ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gg", "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"g", " ", ".", 
     RowBox[{"D", "[", 
      RowBox[{"g", ",", " ", "x"}], "]"}]}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.884888246859906*^9, 3.884888258919745*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"b29a0662-9549-46a5-9d70-112a3a587c75"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{"{", 
           RowBox[{
             RowBox[{
               RowBox[{
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mxf", "[", "x", "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                 RowBox[{"Cos", "[", 
                   RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                 RowBox[{
                   SuperscriptBox[
                   "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                   "x", "]"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mxf", "[", "x", "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}]}], ")"}]}], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "M0f", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mzf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"Mzf", "[", "x", "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"M0f", "[", "x", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}]}], ")"}], "2"], "+", 
               RowBox[{
                 RowBox[{"Cos", "[", 
                   RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], "-", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}]}], ")"}]}], "-", 
               RowBox[{
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "-", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                 RowBox[{
                   SuperscriptBox[
                   "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                   "x", "]"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}]}], ")"}]}], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                  RowBox[{
                    TemplateBox[{"4"}, "OutputSizeLimit`Skeleton"], "+", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]}], ")"}], 
                "2"], "+", 
               RowBox[{
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                 RowBox[{"Sin", "[", 
                   RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}], "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mxf", "[", "x", "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}], "2"]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}]}]}], ")"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mxf", "[", "x", "]"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]\[Prime]", MultilineFunction -> 
                    None], "[", "x", "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"M0f", "[", "x", "]"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Mzf", "[", "x", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}]}]}], ")"}], 
                 " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "M0f", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}], "+", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mzf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"M0f", "[", "x", "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}], "2"]}], "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Mzf", "[", "x", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}], "2"]}], "+", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "M0f", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mzf", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"Mzf", "[", "x", "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]\[Prime]", MultilineFunction -> 
                    None], "[", "x", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"M0f", "[", "x", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]\[Prime]", MultilineFunction -> 
                    None], "[", "x", "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                 RowBox[{"Cos", "[", 
                   RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "-", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}]}], ")"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}], "2"]}], "+", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mxf", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    "Myf", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
                    RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]\[Prime]", MultilineFunction -> 
                    None], "[", "x", "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"Mzf", "[", "x", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"M0f", "[", "x", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}]}]}], ")"}], 
                 " ", 
                 RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "M0f", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}], "+", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mzf", "\[Prime]", MultilineFunction -> None], "[", "x", 
                    "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"Mzf", "[", "x", "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}], "2"]}], "-", 
                    RowBox[{
                    RowBox[{"M0f", "[", "x", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    SuperscriptBox[
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]", MultilineFunction -> None], "[", 
                    "x", "]"}], "2"]}], "+", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "M0f", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}]}], "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "Mzf", "\[Prime]\[Prime]", MultilineFunction -> None], 
                    "[", "x", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{"M0f", "[", "x", "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]\[Prime]", MultilineFunction -> 
                    None], "[", "x", "]"}]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"Mzf", "[", "x", "]"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]f", "[", "x", "]"}], "]"}], " ", 
                    RowBox[{
                    SuperscriptBox[
                    "\[Theta]f", "\[Prime]\[Prime]", MultilineFunction -> 
                    None], "[", "x", "]"}]}]}], ")"}]}]}], ",", 
             TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ",", 
             TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ",", 
             TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]}], "}"}], ",", 
         TemplateBox[{"3"}, "OutputSizeLimit`Skeleton"]}], "}"}], 
     Short[#, 5]& ], "line" -> 339, "sessionID" -> 19539636325041246095, 
   "byteCount" -> 468552, "size" -> 5, "stored" -> False, "expr" -> 
   Missing["NotAvailable", "NewSessionID"], "wrap" -> OutputSizeLimit`Defer, 
   "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{
  3.8848882599296045`*^9, 3.884888416281477*^9, 3.8848884566402364`*^9, 
   3.8920903342622204`*^9, 3.8920904207593403`*^9, {3.892090470190123*^9, 
   3.89209048499822*^9}},
 CellLabel->
  "Out[339]=",ExpressionUUID->"38203a75-f940-427f-98da-c79a03888e59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ggs", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"gg", ",", " ", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"M0f", "[", "x", "]"}], "^", "2"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"Mxf", "[", "x", "]"}], "^", "2"}], " ", "-", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], "^", "2"}], "-", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], "^", "2"}]}], " ", "==", "1"}], ",",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"M0f", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"M0f", "'"}], "[", "x", "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Mxf", "[", "x", "]"}], "^", "2"}], 
          RowBox[{
           RowBox[{"Mxf", "'"}], "[", "x", "]"}]}], " ", "-", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"Myf", "'"}], "[", "x", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"Mzf", "'"}], "[", "x", "]"}]}]}], " ", "==", "0"}]}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.884881961836584*^9, {3.8848819970203424`*^9, 3.8848820455503654`*^9}, {
   3.8848821467989674`*^9, 3.884882169102701*^9}, {3.8848822235614004`*^9, 
   3.884882233052606*^9}, {3.8848838526204467`*^9, 3.8848838548176527`*^9}, {
   3.884886243682234*^9, 3.8848862637164288`*^9}, 3.8848864337006593`*^9, 
   3.8848881154164886`*^9, {3.8848881869198275`*^9, 3.884888190025898*^9}, {
   3.8848882495995445`*^9, 3.8848882568094826`*^9}, {3.8848885573964195`*^9, 
   3.884888586943584*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"23b10f5b-e2fc-49de-b1ce-e48203c28ca5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mxf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Myf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Mxf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{
           SuperscriptBox["M0f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Theta]f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Theta]f", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
         RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["Myf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mxf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Myf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["Myf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Mxf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{
           SuperscriptBox["M0f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Theta]f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Theta]f", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Mxf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{
           SuperscriptBox["M0f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Theta]f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[Theta]f", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"Mxf", "[", "x", "]"}]}], "-", 
         RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["Myf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mxf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Myf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
         RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["Myf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Mxf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{
           SuperscriptBox["M0f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Theta]f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Mzf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[Theta]f", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mxf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Myf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}], "2"], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8848819621671658`*^9, {3.8848819943145747`*^9, 3.8848820460388207`*^9}, 
   3.8848821713693953`*^9, 3.884882234293187*^9, {3.884883855259307*^9, 
   3.8848838704903502`*^9}, {3.8848839009433107`*^9, 3.884883918639738*^9}, {
   3.8848862669724293`*^9, 3.884886278130435*^9}, 3.8848864352928915`*^9, {
   3.8848880893932805`*^9, 3.884888116219127*^9}, 3.8848881911693964`*^9, 
   3.8848882629972334`*^9, 3.884888413099985*^9, 3.884888457536208*^9, 
   3.8848885881251316`*^9, 3.892090337047639*^9, 3.892090421233878*^9, {
   3.8920904707726173`*^9, 3.8920904854297476`*^9}},
 CellLabel->
  "Out[340]=",ExpressionUUID->"e28bbd8e-f33a-4bf0-b5f6-2814e91e2398"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"I", " ", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Tr", "[", 
     RowBox[{"gg", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
   "4"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"gg", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"gg", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"gg", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}]}], "Input",
 CellChangeTimes->{{3.884888105518759*^9, 3.8848881093137393`*^9}},
 CellLabel->
  "In[341]:=",ExpressionUUID->"8d40e17c-79dc-41c2-abbb-af857229ed88"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"M0f", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["M0f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Mxf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Mxf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Myf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Myf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Mzf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Mzf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["\[Theta]f", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{{3.8848881098174515`*^9, 3.884888117626631*^9}, 
   3.884888457669209*^9, 3.8848885931296253`*^9, 3.892090337502522*^9, 
   3.8920904214100018`*^9, {3.892090470895224*^9, 3.89209048561709*^9}},
 CellLabel->
  "Out[341]=",ExpressionUUID->"1dcaa8bb-ecf9-4313-8b65-7ceb671f9b44"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"Mxf", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["M0f", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"M0f", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["Mxf", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8848881098174515`*^9, 3.884888117626631*^9}, 
   3.884888457669209*^9, 3.8848885931296253`*^9, 3.892090337502522*^9, 
   3.8920904214100018`*^9, {3.892090470895224*^9, 3.892090485640979*^9}},
 CellLabel->
  "Out[342]=",ExpressionUUID->"ed4be803-05e2-40d3-acb9-4d45b38422bd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"Myf", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["M0f", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"M0f", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["Myf", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8848881098174515`*^9, 3.884888117626631*^9}, 
   3.884888457669209*^9, 3.8848885931296253`*^9, 3.892090337502522*^9, 
   3.8920904214100018`*^9, {3.892090470895224*^9, 3.8920904856601753`*^9}},
 CellLabel->
  "Out[343]=",ExpressionUUID->"a296a2c4-875d-4637-8cf7-b034af7cde15"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"Mzf", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["M0f", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"M0f", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["Mzf", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8848881098174515`*^9, 3.884888117626631*^9}, 
   3.884888457669209*^9, 3.8848885931296253`*^9, 3.892090337502522*^9, 
   3.8920904214100018`*^9, {3.892090470895224*^9, 3.8920904856759787`*^9}},
 CellLabel->
  "Out[344]=",ExpressionUUID->"fb29015a-c509-40be-a414-83256a7cc866"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"M0f", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["M0f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Mxf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Mxf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Myf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Myf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Mzf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Mzf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Input",
 CellLabel->
  "In[345]:=",ExpressionUUID->"25aaf5b2-4881-4233-8f74-ad1439beab75"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"M0f", "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["M0f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Mxf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Mxf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Myf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Myf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Mzf", "[", "x", "]"}], " ", 
      RowBox[{
       SuperscriptBox["Mzf", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]f", "\[Prime]",
     MultilineFunction->None], "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8920903378646207`*^9, 3.892090421617222*^9, {3.8920904710723715`*^9, 
   3.8920904858120575`*^9}},
 CellLabel->
  "Out[345]=",ExpressionUUID->"d8850219-d4d2-4bcb-a3ce-ade9fe080ef0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bd", " ", "=", "  ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"g", " ", ".", 
     RowBox[{"D", "[", 
      RowBox[{"g", ",", " ", "x"}], "]"}]}], ",", " ", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"M0f", "[", "x", "]"}], "^", "2"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"Mxf", "[", "x", "]"}], "^", "2"}], " ", "-", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], "^", "2"}], "-", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], "^", "2"}]}], " ", "==", "1"}], ",",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"M0f", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"M0f", "'"}], "[", "x", "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Mxf", "[", "x", "]"}], "^", "2"}], 
          RowBox[{
           RowBox[{"Mxf", "'"}], "[", "x", "]"}]}], " ", "-", 
         RowBox[{
          RowBox[{"Myf", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"Myf", "'"}], "[", "x", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Mzf", "[", "x", "]"}], 
          RowBox[{
           RowBox[{"Mzf", "'"}], "[", "x", "]"}]}]}], " ", "==", "0"}]}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.884888782030064*^9, 3.8848888063898506`*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"9c014b5a-0847-4aa6-bb8a-cc137f8fefde"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Mzf", "[", "x", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Theta]f", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
         RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["Myf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["Myf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Theta]f", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Mzf", "[", "x", "]"}]}], " ", 
         RowBox[{
          SuperscriptBox["M0f", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], "+", 
        RowBox[{
         RowBox[{"M0f", "[", "x", "]"}], " ", 
         RowBox[{
          SuperscriptBox["Mzf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{
          SuperscriptBox["\[Theta]f", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"Mxf", "[", "x", "]"}]}], "-", 
         RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Mxf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["Myf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Mzf", "[", "x", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"Mxf", "[", "x", "]"}]}], "+", 
         RowBox[{"Myf", "[", "x", "]"}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Mzf", "[", "x", "]"}], " ", 
         RowBox[{
          SuperscriptBox["M0f", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], "-", 
        RowBox[{
         RowBox[{"M0f", "[", "x", "]"}], " ", 
         RowBox[{
          SuperscriptBox["Mzf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{
          SuperscriptBox["\[Theta]f", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"M0f", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["M0f", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mxf", "[", "x", "]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Myf", "[", "x", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Mxf", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{
           SuperscriptBox["Myf", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"Mzf", "[", "x", "]"}], " ", 
       RowBox[{
        SuperscriptBox["Mzf", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8848887899496555`*^9, 3.884888808224784*^9}, 
   3.892090338728213*^9, 3.8920904217636695`*^9, {3.8920904712537527`*^9, 
   3.8920904859861145`*^9}},
 CellLabel->
  "Out[346]=",ExpressionUUID->"848d6936-b95c-4c0c-8f6a-afca3ad93944"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"I", " ", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Tr", "[", 
     RowBox[{"bd", ".", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
        RowBox[{"PauliMatrix", "[", "0", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
   "4"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"bd", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"bd", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Tr", "[", 
    RowBox[{"bd", ".", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "2", "]"}], ",", " ", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}], "]"}], "]"}], "/", 
  "4"}]}], "Input",
 CellChangeTimes->{{3.8848888371443224`*^9, 3.8848888433986483`*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"19cb0119-8a26-4e7e-a1df-4410e5a843b7"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   SuperscriptBox["\[Theta]f", "\[Prime]",
    MultilineFunction->None], "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{{3.8848888146450167`*^9, 3.8848888437598076`*^9}, 
   3.8920903388704195`*^9, 3.8920904218680573`*^9, {3.892090471420943*^9, 
   3.892090486112096*^9}},
 CellLabel->
  "Out[347]=",ExpressionUUID->"d65b6021-0c16-4d53-be7e-bee78993bab8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"Mxf", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["M0f", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"M0f", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["Mxf", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8848888146450167`*^9, 3.8848888437598076`*^9}, 
   3.8920903388704195`*^9, 3.8920904218680573`*^9, {3.892090471420943*^9, 
   3.892090486138652*^9}},
 CellLabel->
  "Out[348]=",ExpressionUUID->"b0550587-2080-4a9a-8b27-ee1861ffcf80"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"Myf", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["M0f", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"M0f", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["Myf", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8848888146450167`*^9, 3.8848888437598076`*^9}, 
   3.8920903388704195`*^9, 3.8920904218680573`*^9, {3.892090471420943*^9, 
   3.89209048616186*^9}},
 CellLabel->
  "Out[349]=",ExpressionUUID->"98d9ed7b-5698-4768-a3a5-1a01097ad32f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"Mzf", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["M0f", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"M0f", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["Mzf", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8848888146450167`*^9, 3.8848888437598076`*^9}, 
   3.8920903388704195`*^9, 3.8920904218680573`*^9, {3.892090471420943*^9, 
   3.8920904861889925`*^9}},
 CellLabel->
  "Out[350]=",ExpressionUUID->"f9cd6e3d-d376-4dab-b38e-6bf77f3325b8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.6 Inherited,
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"573309e6-485a-49c8-b7cf-49698684a80c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 203, 3, 59, "Title",ExpressionUUID->"f4f6e3f8-cae6-4977-aed0-7aa8d93aa800"],
Cell[786, 27, 305, 7, 19, "Input",ExpressionUUID->"f6f96913-ebcd-4450-a55c-46890a450925"],
Cell[CellGroupData[{
Cell[1116, 38, 163, 3, 32, "Subsection",ExpressionUUID->"ace95b84-f794-4ef7-911d-59d9c6541adf"],
Cell[1282, 43, 747, 16, 19, "Input",ExpressionUUID->"cb4c2bde-7c3c-4179-b5e5-a1e5bd65c6e2"],
Cell[CellGroupData[{
Cell[2054, 63, 2163, 52, 63, "Input",ExpressionUUID->"958d1f58-fa67-413c-861f-0f6a3e92f0ae"],
Cell[4220, 117, 4266, 122, 61, "Output",ExpressionUUID->"a25f112b-2733-417c-9284-731da6b24626"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8535, 245, 161, 3, 32, "Subsection",ExpressionUUID->"6095120b-057c-40fd-93b8-b5ec2c1d2345"],
Cell[CellGroupData[{
Cell[8721, 252, 1497, 37, 29, "Input",ExpressionUUID->"e0a295bc-43dd-48c2-9fea-9996a96e7b55"],
Cell[10221, 291, 4690, 122, 61, "Output",ExpressionUUID->"ecffd719-8245-4ecd-9dc6-74f6f091a482"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14948, 418, 1577, 42, 52, "Input",ExpressionUUID->"a317a16c-edb9-4601-a3fb-065d9012d77f"],
Cell[16528, 462, 737, 15, 30, "Output",ExpressionUUID->"b961f5bf-7465-4bfc-9772-4cf33b52b21b"],
Cell[17268, 479, 737, 15, 30, "Output",ExpressionUUID->"ec172b0c-8fba-4da9-bc33-c3f49350b417"],
Cell[18008, 496, 739, 15, 30, "Output",ExpressionUUID->"c6f79f6c-98d3-4053-806d-ad2a1039e6a6"],
Cell[18750, 513, 739, 15, 30, "Output",ExpressionUUID->"a38a5518-d394-4321-9bbe-c3ba4788bc5e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19538, 534, 223, 4, 32, "Subsection",ExpressionUUID->"ac6451c9-f360-4aae-871b-7588614ee5da"],
Cell[CellGroupData[{
Cell[19786, 542, 3423, 77, 52, "Input",ExpressionUUID->"2a2c8d3e-cc54-4720-ba0d-142ceca47fa1"],
Cell[23212, 621, 4275, 122, 85, "Output",ExpressionUUID->"b0c189ae-6528-474f-ae76-4d13b6967378"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27524, 748, 2253, 64, 63, "Input",ExpressionUUID->"ed54b07f-d7a9-4f90-978f-564a3ffe0f40"],
Cell[29780, 814, 578, 9, 30, "Output",ExpressionUUID->"268715c3-8bd8-4ba1-983d-5daec168b9e8"],
Cell[30361, 825, 602, 10, 30, "Output",ExpressionUUID->"392242bd-6977-4cdb-8654-005418f4c8df"],
Cell[30966, 837, 604, 10, 30, "Output",ExpressionUUID->"fd180499-3e0a-44a2-a947-8cc29a471fad"],
Cell[31573, 849, 602, 10, 30, "Output",ExpressionUUID->"ace665c9-2f1c-4b30-aa16-705ecb6a9a59"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32224, 865, 173, 3, 32, "Subsection",ExpressionUUID->"af7e8b29-3b7c-405b-a611-c8d3c2cccbda"],
Cell[CellGroupData[{
Cell[32422, 872, 3061, 70, 86, "Input",ExpressionUUID->"f5c729a7-f11e-4c03-b124-38d36cb5ef47"],
Cell[35486, 944, 4216, 114, 73, "Output",ExpressionUUID->"de46acf1-38ac-48cc-b004-0a05caaa65d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39739, 1063, 2544, 68, 52, "Input",ExpressionUUID->"ddc54383-b900-4e3d-ad43-ec1a19b8f514"],
Cell[42286, 1133, 1118, 24, 31, "Output",ExpressionUUID->"4a707cb5-8eb3-48e5-bba2-73f47466c711"],
Cell[43407, 1159, 870, 15, 30, "Output",ExpressionUUID->"d60e2611-a46d-4828-9cb5-988749db06ab"],
Cell[44280, 1176, 869, 15, 30, "Output",ExpressionUUID->"e275b9d9-d091-4b1c-b46a-2c7d3f23b5b9"],
Cell[45152, 1193, 870, 15, 30, "Output",ExpressionUUID->"4405c21e-cb10-4301-a940-826e666f3db3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46071, 1214, 170, 3, 32, "Subsection",ExpressionUUID->"9f34d863-cd68-4e1c-995d-14385d193cfe"],
Cell[CellGroupData[{
Cell[46266, 1221, 1164, 27, 29, "Input",ExpressionUUID->"d55d71fa-1c0f-478f-984b-77ce3053a3c2"],
Cell[47433, 1250, 4129, 114, 73, "Output",ExpressionUUID->"723b5173-3ab2-4eac-b391-f2117d258434"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51599, 1369, 1977, 60, 52, "Input",ExpressionUUID->"bbfbe4c2-a33e-4d42-b63e-fae89452f79c"],
Cell[53579, 1431, 643, 17, 31, "Output",ExpressionUUID->"543ae634-8674-4d8d-a8e6-28dc250bd8ec"],
Cell[54225, 1450, 411, 8, 30, "Output",ExpressionUUID->"56d475dd-eed4-4f89-b175-b72f5dadb84a"],
Cell[54639, 1460, 411, 8, 30, "Output",ExpressionUUID->"bf08e0ee-e2fc-4764-a335-a202851f8c54"],
Cell[55053, 1470, 411, 8, 30, "Output",ExpressionUUID->"06d65724-c685-487b-95e4-578ac8682963"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55513, 1484, 164, 3, 32, "Subsection",ExpressionUUID->"70e552d2-be1a-4bae-9319-9e71b4be8916"],
Cell[55680, 1489, 715, 19, 63, "Input",ExpressionUUID->"20f3a298-04e6-44bf-ab36-6fd7b38de6ab"],
Cell[CellGroupData[{
Cell[56420, 1512, 344, 9, 19, "Input",ExpressionUUID->"b29a0662-9549-46a5-9d70-112a3a587c75"],
Cell[56767, 1523, 24956, 540, 142, "Output",ExpressionUUID->"38203a75-f940-427f-98da-c79a03888e59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81760, 2068, 1841, 47, 19, "Input",ExpressionUUID->"23b10f5b-e2fc-49de-b1ce-e48203c28ca5"],
Cell[83604, 2117, 20042, 548, 115, "Output",ExpressionUUID->"e28bbd8e-f33a-4bf0-b5f6-2814e91e2398"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103683, 2670, 1431, 40, 52, "Input",ExpressionUUID->"8d40e17c-79dc-41c2-abbb-af857229ed88"],
Cell[105117, 2712, 1429, 39, 22, "Output",ExpressionUUID->"1dcaa8bb-ecf9-4313-8b65-7ceb671f9b44"],
Cell[106549, 2753, 788, 20, 32, "Output",ExpressionUUID->"ed4be803-05e2-40d3-acb9-4d45b38422bd"],
Cell[107340, 2775, 790, 20, 32, "Output",ExpressionUUID->"a296a2c4-875d-4637-8cf7-b034af7cde15"],
Cell[108133, 2797, 790, 20, 32, "Output",ExpressionUUID->"fb29015a-c509-40be-a414-83256a7cc866"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108960, 2822, 1100, 33, 19, "Input",ExpressionUUID->"25aaf5b2-4881-4233-8f74-ad1439beab75"],
Cell[110063, 2857, 1224, 36, 22, "Output",ExpressionUUID->"d8850219-d4d2-4bcb-a3ce-ade9fe080ef0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111324, 2898, 1494, 43, 19, "Input",ExpressionUUID->"9c014b5a-0847-4aa6-bb8a-cc137f8fefde"],
Cell[112821, 2943, 12526, 359, 54, "Output",ExpressionUUID->"848d6936-b95c-4c0c-8f6a-afca3ad93944"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125384, 3307, 1433, 40, 52, "Input",ExpressionUUID->"19cb0119-8a26-4e7e-a1df-4410e5a843b7"],
Cell[126820, 3349, 397, 9, 22, "Output",ExpressionUUID->"d65b6021-0c16-4d53-be7e-bee78993bab8"],
Cell[127220, 3360, 730, 20, 32, "Output",ExpressionUUID->"b0550587-2080-4a9a-8b27-ee1861ffcf80"],
Cell[127953, 3382, 729, 20, 41, "Output",ExpressionUUID->"98d9ed7b-5698-4768-a3a5-1a01097ad32f"],
Cell[128685, 3404, 732, 20, 32, "Output",ExpressionUUID->"f9cd6e3d-d376-4dab-b38e-6bf77f3325b8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

